table inet Firewall {
	set rateLimitedIPv4 {
		type ipv4_addr
		size 65535
		flags dynamic,timeout
		timeout 3h
	}

	set rateLimitedIPv6 {
		type ipv6_addr
		size 65535
		flags dynamic,timeout
		timeout 3h
	}

	chain inbound {
		type filter hook input priority filter; policy drop;

		# Rate Limiting (Only for TCP Traffic):
		tcp dport 53 add @rateLimitedIPv4 { ip saddr limit rate over 128 kbytes/minute burst 64 kbytes } counter packets 0 bytes 0 drop
		tcp dport 53 add @rateLimitedIPv6 { ip6 saddr limit rate over 128 kbytes/minute burst 64 kbytes } counter packets 0 bytes 0 drop

		# DNS Traffic:
		tcp dport 53 counter packets 0 bytes 0 accept
		udp dport 53 counter packets 0 bytes 0 accept

		# SSH Traffic:
		tcp dport 58763 counter packets 0 bytes 0 accept

		# Loopback Interface:
		iif "lo" accept

		# Connection-Based:
		ct state established,related accept
		ct state invalid drop
	}
}
